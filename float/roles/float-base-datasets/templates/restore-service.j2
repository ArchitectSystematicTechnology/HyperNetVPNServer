{% set required_by = service.systemd_services | default([]) %}

[Unit]
Description=Restore dataset {{ dataset_name }}
Before={{ required_by | join(' ') }}

[Service]
{% if backup_repository_uri is defined %}
ExecStart=/usr/lib/float/datasets/restore-{{ dataset_filename }}
{% else %}
ExecStart=/bin/true
{% endif %}
Type=oneshot
RemainAfterExit=true

[Install]
RequiredBy={{ required_by | join(' ') }}
